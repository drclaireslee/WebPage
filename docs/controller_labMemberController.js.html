<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: controller/labMemberController.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: controller/labMemberController.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import baseController from "./baseController.js";
import {labMemberZod} from "../model/labMemberModel.js"
import customError from "../middleware/customError.js";
import { put, del } from '@vercel/blob';
import mongoose from "mongoose";


/**
 * @extends baseController
 */
class labMemberController extends baseController {
	/**
	 * create a labMemberController
     */
	constructor() {
		super("LabMember", labMemberZod);
		this.defaultURL = "https://drclaireslee-backend.vercel.app/img/labMembers/default.jpg";
	}

	/**
	 * Returns the a file extension for a given string representation of a mimetype
	 * @param {string} mimetype - String representation of a mimetype
	 * @return {Promise&lt;Object>} A JSON response object containing a message.
	 * @throws {customError} If mime type is not a valid type for labMemberController
	 * @example
	 * 
	 *  const controller = new labMemberController();
	 *  console.log(controller.getFileExtension("image/jpeg"));
	 *  //logs "jpg"
	 */
	async getFileExtension(mimetype) {
		switch (mimetype) {
		case "image/jpeg":
			return "jpg";
		case "image/png":
			return "png";
		case "image/webp":
			return "webp";
		default:
			throw new customError(400, "Bad Request: Unsupported image type");
		}
	}

	async create(req, res) {
		const _id = new mongoose.Types.ObjectId();
		if (req.file) {
			const fileExtension = await this.getFileExtension(req.file.mimetype);
			const blob = await put(`/img/labMembers/${_id}.${fileExtension}`, req.file.buffer, {
				access: "public",
				allowOverwrite: true,
				addRandomSuffix: false
			});
			req.body.imageURL = blob.url;
		} else {
			req.body.imageURL = this.defaultURL;
		}
		const model = await this.getModel();
	    const doc = this.validateDocument(req.body);
		doc["_id"] = _id;
	    const createdDoc = await model.create(doc);
		return res.status(201).json(createdDoc);
	}

	async delete(req, res) {
		const model = await this.getModel();
	    const result = await model.findById(req.params._id).exec();
		if (result.imageURL != this.defaultURL) {
			del(result.imageURL);
		}
		return super.delete(req, res);
	}

	async update(req, res) {
		if (req.file) {
			const fileExtension = await this.getFileExtension(req.file.mimetype);
			const blob = await put(`/img/labMembers/${req.params._id}.${fileExtension}`, req.file.buffer, {
				access: "public",
				allowOverwrite: true,
				addRandomSuffix: false
			});
			req.body.imageURL = blob.url;
		}
		return super.update(req, res);
	}
}


export default labMemberController;</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Externals</h3><ul><li><a href="external-express.html">express</a></li><li><a href="external-jsonwebtoken.html">jsonwebtoken</a></li><li><a href="external-mongoose.html">mongoose</a></li><li><a href="external-zod.html">zod</a></li></ul><h3>Classes</h3><ul><li><a href="baseController.html">baseController</a></li><li><a href="customError.html">customError</a></li><li><a href="editorController.html">editorController</a></li><li><a href="labMemberController.html">labMemberController</a></li><li><a href="publicationController.html">publicationController</a></li><li><a href="researchController.html">researchController</a></li></ul><h3>Global</h3><ul><li><a href="global.html#access">access</a></li><li><a href="global.html#accessAdmin">accessAdmin</a></li><li><a href="global.html#accessUpdateUser">accessUpdateUser</a></li><li><a href="global.html#auth">auth</a></li><li><a href="global.html#authAdmin">authAdmin</a></li><li><a href="global.html#connectionHelperReturnsaconnectiontothedatabase">connectionHelperReturns a connection to the database</a></li><li><a href="global.html#errorHandler">errorHandler</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Mon Dec 01 2025 21:53:47 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
